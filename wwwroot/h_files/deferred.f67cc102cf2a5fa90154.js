(window["jsonp-common-entrypoints"]=window["jsonp-common-entrypoints"]||[]).push([["auto/base-modules/header/deferred"],{MpKF:function(e,t,a){"use strict";var r=a("XkxG");var n=a("ih51");function l(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:true,configurable:true,writable:true}):e[t]=a;return e}class o{constructor(){l(this,"localeOverlay",void 0);l(this,"wtOverlay",void 0);this.localeOverlay=null;this.wtOverlay=null}static getInstance(){o.instance||(o.instance=new o);return o.instance}init(){if(this.wtOverlay&&this.localeOverlay)return true;const e=document.getElementById("wt-locale-picker-overlay");if(!e)return false;this.wtOverlay||(this.wtOverlay=new r["a"](e,{customTrigger:true}));if(!this.localeOverlay){const t=document.getElementById("locale-overlay-save");if(t){this.localeOverlay=new n["a"]({overlay:e,saveButton:t});t.addEventListener("click",(()=>{this.saveLocalePreferences()}))}}return true}openWtOverlay(e){e.preventDefault();this.wtOverlay&&this.wtOverlay.open()}saveLocalePreferences(){this.localeOverlay&&this.localeOverlay.saveLocalePreferences()}}l(o,"instance",void 0);const c=o.getInstance();t["a"]=c},ih51:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var r=a("69CB");var n=a("w1yB");var l=a("Z2Mz");var o=a("w4t9");var c=a("oVvz");var i=function(e={}){const t="/api/v3/ajax/member/locale-preferences";const a={};if(e){e.hasOwnProperty("currency_code")&&(a["currency_code"]=e["currency_code"]);e.hasOwnProperty("language_code")&&(a["language_code"]=e["language_code"]);e.hasOwnProperty("region_code")&&(a["region_code"]=e["region_code"]);e.hasOwnProperty("currency")&&(a["currency"]=e["currency"]);e.hasOwnProperty("language")&&(a["language"]=e["language"]);e.hasOwnProperty("region")&&(a["region"]=e["region"])}return{headers:{"x-csrf-token":Object(o["a"])(),"x-detected-locale":Object(c["a"])()},data:a,url:t,type:"POST"}};var s=a("H3fw");function u(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:true,configurable:true,writable:true}):e[t]=a;return e}class d{constructor({overlay:e,saveButton:t}){u(this,"overlay",void 0);u(this,"saveButton",void 0);this.overlay=e;this.saveButton=t}getSelectedLocale(){return{language:this.getElementValue("#locale-overlay-select-language_code"),currency:this.getElementValue("#locale-overlay-select-currency_code"),region:this.getElementValue("#locale-overlay-select-region_code")}}getElementValue(e){var t,a;return(null===(t=this.overlay)||void 0===t||null===(a=t.querySelector(e))||void 0===a?void 0:a.value)||""}addSpinner(){this.saveButton.classList.add("wt-btn--is-loading")}logEvent(e){s["default"].logEvent({event_name:e,ui:"overlay",trigger:"footer",...this.getSelectedLocale()})}saveLocalePreferences(){const e=n["a"].featureIsEnabled("isAppShellEnabled")?"localization.locale_settings.picker_app_shell.error":"localization.locale_settings.picker.error";const t=n["a"].featureIsEnabled("isAppShellEnabled")?"localization.locale_settings.picker_app_shell.update":"localization.locale_settings.picker.update";this.addSpinner();const a=i(this.getSelectedLocale());return Object(r["a"])(a).then((e=>e.ok?Promise.resolve():Promise.reject())).then((()=>{l["a"].increment(t);this.logEvent("set_locale_preferences");const e=window.location.href;const a=new URL(e);const r="locale_override";a.searchParams.has(r)?this.deleteParamAndLoadPage(a,r):window.location.reload()})).catch((()=>{l["a"].increment(e);this.logEvent("set_locale_preferences_failure")}))}deleteParamAndLoadPage(e,t){e.searchParams.delete(t);window.location.href=e.toString()}}},qzGY:function(e,t,a){"use strict";a.r(t);var r=a("w1yB");var n=a("V9r9");var l=a("MpKF");var o=a("H3fw");const c=()=>{if(!l["a"].init())return;const e=document.getElementById("header-locale-picker-trigger");if(null!==e){const t=e.getAttribute("data-aria-controls");e.setAttribute("role","button");t&&e.setAttribute("aria-controls",t);e.addEventListener("click",(e=>{l["a"].openWtOverlay(e);o["default"].logEvent({event_name:"set_locale_preferences_header"})}));e.addEventListener("keydown",(e=>{if(e.keyCode===n["a"].SPACE){l["a"].openWtOverlay(e);o["default"].logEvent({event_name:"set_locale_preferences_header"})}}))}};var i={init:c};r["a"].getBoolean("locale_acknowledgement_enabled",false)&&i.init()}}]);
//# sourceMappingURL=https://www.etsy.com/sourcemaps/evergreenVendor/en-US/async/common-entrypoints/auto/base-modules/header/deferred.f67cc102cf2a5fa90154.js.map