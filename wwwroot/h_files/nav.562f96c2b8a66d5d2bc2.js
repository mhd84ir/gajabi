(window["jsonp-common-entrypoints"]=window["jsonp-common-entrypoints"]||[]).push([["auto/bootstrap/category-nav/v2/nav"],{"g/Ib":function(t,e,a){"use strict";a.r(e);var i=a("3a3M");var n=a.n(i);var s=a("vBnV");var o=a("V9r9");var r={setMenubarKeyboardNavigation(t){function e(e){const a=e.attr("id");t.attr("aria-activedescendant",a);e.trigger("focus")}if("menubar"!==t.attr("role"))throw new Error(`${t} must have a role set to "menubar".`);const a=t.find('[role="menuitem"]').filter(":not(:disabled)").filter(":not(:hidden)");t.off("keydown.a11yMenubarFocus");t.on("keydown.a11yMenubarFocus",(t=>{if(t.keyCode===o["a"].RIGHT||t.keyCode===o["a"].LEFT){t.preventDefault();const i=n()(document.activeElement);const s=a.index(i);if(t.keyCode===o["a"].LEFT){if(0===s){e(a.eq(a.length-1));return}e(a.eq(s-1))}if(t.keyCode===o["a"].RIGHT){if(s===a.length-1){e(a.first());return}e(a.eq(s+1))}}if(t.keyCode===o["a"].ENTER||t.keyCode===o["a"].SPACE||t.keyCode===o["a"].DOWN){t.preventDefault();n()(t.target).trigger("menubar-item-press")}}))}};var c=a("E1kl");var d=a("H3fw");var v=a("Z2Mz");var h=a("+s1y");var u=a("uEZf");var l=a("w1yB");function N(t,e,a){e in t?Object.defineProperty(t,e,{value:a,enumerable:true,configurable:true,writable:true}):t[e]=a;return t}const m={TOP_NAV_CATEGORY_LIST:'[data-ui="top-nav-category-list"]',TOP_NAV_CATEGORY_LINK:'[data-ui="top-nav-category-link"]',TOP_NAV_PROMO_LINK:'[data-ui="top-nav-promo-link"]',ONSALE_LINK:'[data-ui="desktop-catnav-onsale-link"]',PROMO:'[data-ui="promo"]',SUB_NAV:'[data-ui="sub-nav"]',SIDE_NAV_CATEGORY_LIST:'[data-ui="side-nav-category-list"]',SIDE_NAV_CATEGORY_LINK:'[data-ui="side-nav-category-link"]',TERTIARY_NAV:'[data-ui="tertiary-nav"]',TERTIARY_NAV_PROMO_LINK:'[data-ui="tertiary-nav-promo-link"]',MENUITEM:'[role="menuitem"]',MENU:'[role="menu"]',ACTIVE_NAV_ITEM_INDICATOR:'[data-ui="active-nav-item-indicator"]'};const _={DISPLAY_NONE:"wt-display-none"};const A={MOUSE_LEAVE_TIMEOUT:400,MOUSE_ENTER_TIMEOUT:350,MOUSE_ENTER_DROPDOWN_DELAY:200};class E{constructor(t){N(this,"$context",void 0);N(this,"$topNavCategoryList",void 0);N(this,"$navCategoryLinks",void 0);N(this,"$navPromoLinks",void 0);N(this,"allNavLinks",void 0);N(this,"storedNavItemPositionAndWidthInfo",void 0);N(this,"$sideNavCategoryList",void 0);N(this,"$sideNavCategoryLinks",void 0);N(this,"$tertiaryNavs",void 0);N(this,"$searchResults",void 0);N(this,"$promos",void 0);N(this,"$activeNavItemIndicator",void 0);N(this,"mouseEnterNavItemTimeout",void 0);N(this,"leaveNavTimeout",void 0);N(this,"hideSubNav",void 0);this.$context=t;this.$topNavCategoryList=this.$context.find(m.TOP_NAV_CATEGORY_LIST);this.$navCategoryLinks=this.$context.find(m.TOP_NAV_CATEGORY_LINK);this.$navPromoLinks=this.$context.find(m.TOP_NAV_PROMO_LINK);this.allNavLinks=this.getAllNavLinks();this.storedNavItemPositionAndWidthInfo=this.setStoredNavItemPositionAndWidthInfo();this.$sideNavCategoryList=this.$context.find(m.SIDE_NAV_CATEGORY_LIST);this.$sideNavCategoryLinks=this.$context.find(m.SIDE_NAV_CATEGORY_LINK);this.$tertiaryNavs=this.$context.find(m.TERTIARY_NAV);this.$searchResults=n()(".gnav-search-inner").find("[data-id='search-suggestions']");this.$promos=this.$context.find(m.PROMO);this.$activeNavItemIndicator=this.$context.find(m.ACTIVE_NAV_ITEM_INDICATOR);this.mouseEnterNavItemTimeout=null;this.leaveNavTimeout=null;this.hideSubNav=l["a"].getBoolean("should_hide_sub_nav",false);this.bindEvents();u["default"].setup(this.$context)}bindEvents(){this.$context.on("mouseenter",m.SUB_NAV,this.onMouseEnterNav.bind(this)).on("mouseenter",m.TOP_NAV_CATEGORY_LIST,this.onMouseEnterNav.bind(this)).on("mouseenter",m.SUB_NAV,this.clearMouseEnterNavItem.bind(this)).on("mouseenter click",m.TOP_NAV_CATEGORY_LINK,this.onMouseEnterNavItem.bind(this)).on("click",m.ONSALE_LINK,(()=>{d["default"].logEvent({event_name:"desktop_nav_onsale_click"})})).on("mouseleave",m.SUB_NAV,this.onMouseLeaveNav.bind(this)).on("mouseleave",m.TOP_NAV_CATEGORY_LIST,this.onMouseLeaveNav.bind(this)).on("mouseenter",m.TOP_NAV_PROMO_LINK,this.onMouseEnterPromoItem.bind(this)).on("click",m.TOP_NAV_PROMO_LINK,(t=>{const e=n()(t.currentTarget).data("eventName");d["default"].logEvent({event_name:"nav_promo_click",promo_name:e})})).on("click",m.TERTIARY_NAV_PROMO_LINK,(t=>{const e=n()(t.currentTarget).data("nodeId");d["default"].logEvent({event_name:"tertiary_nav_promo_click",node_id:e})})).on("click",m.SIDE_NAV_CATEGORY_LINK,this.onMouseClickSideNavItem.bind(this)).on("mouseenter",m.SIDE_NAV_CATEGORY_LINK,(t=>{const e=n()(t.currentTarget);const a=e.data("node-id");d["default"].logEvent({event_name:"desktop-nav-side-menu-hover",node_id:a})})).on("mouseenter",m.TOP_NAV_CATEGORY_LINK,(t=>{const e=n()(t.currentTarget);const a=e.data("node-id");d["default"].logEvent({event_name:"desktop-nav-top-hover",node_id:a})}));this.$sideNavCategoryList.menuAim({activate:this.onMouseEnterSideNavItem.bind(this),deactivate:n.a.noop,submenuSelector:"li"});this.setA11yInitialStateMenubar().bindA11yEvents().bindA11yEventsSideNav().bindA11yEventsTertiaryNav().bindGetNavItemInfoOnWindowResize()}bindNavClickLogEvents(t,e){const a=n()(t.currentTarget).data("linkable");a?d["default"].logEvent({event_name:"top_nav_linkable_onclick",node_id:e}):d["default"].logEvent({event_name:"top_nav_not_linkable_onclick",node_id:e})}onMouseEnterNav(){this.clearLeaveNavTimeout()}onMouseEnterNavItem(t){const e=n()(t.currentTarget);const a=e.data("node-id");const i=this.hasActiveTopNavLink()?A.MOUSE_ENTER_DROPDOWN_DELAY:A.MOUSE_ENTER_TIMEOUT;this.clearMouseEnterNavItem();this.$searchResults.hide();"click"===t.type&&this.bindNavClickLogEvents(t,a);this.hideSubNav?this.mouseEnterNavItemTimeout=window.setTimeout((()=>{this.makeActiveNavItem(e)}),i):this.mouseEnterNavItemTimeout=window.setTimeout((()=>{this.makeActiveNavItem(e).hide(m.SUB_NAV).show(m.SUB_NAV+this.getDataAttributeString(a)).activateSubNav(a,false)}),i)}onKeyActivateTopNavItem(t){const e=t.data("node-id");const a=m.SUB_NAV+this.getDataAttributeString(e);this.hideSubNav?this.clearMouseEnterNavItem().makeActiveNavItem(t):this.clearMouseEnterNavItem().makeActiveNavItem(t).hide(m.SUB_NAV).show(a).activateSubNav(e,true)}activateSubNav(t,e){let a=m.SUB_NAV+this.getDataAttributeString(t);const i=this.getFirstFocusableChildForSelector(`${a} ${m.SIDE_NAV_CATEGORY_LINK}`).parent("li");if(i.length){this.makeSideNavItemActive(i).setAriaActiveDescendant(`${a} ${m.SIDE_NAV_CATEGORY_LIST}`,i.attr("id"));e&&this.setMenuKeyboardNavigation(`${a} ${m.SIDE_NAV_CATEGORY_LIST}`).getFirstFocusableChildForSelector(`${a} ${m.SIDE_NAV_CATEGORY_LIST}`).trigger("focus")}else{a=m.TERTIARY_NAV+this.getDataAttributeString(t);this.show(a);e&&this.setMenuKeyboardNavigation(a).getFirstFocusableChildForSelector(a).trigger("focus")}return this}onMouseEnterPromoItem(t){this.clearLeaveNavTimeout().makeActiveNavItem(n()(t.currentTarget)).clearMouseEnterNavItem().hide(m.SUB_NAV)}onMouseLeaveNav(){this.clearLeaveNavTimeout().clearMouseEnterNavItem();this.leaveNavTimeout=window.setTimeout((()=>{this.shrinkActiveNavItemIndicator();this.clearActiveNavItems().hide(m.SUB_NAV)}),A.MOUSE_LEAVE_TIMEOUT)}onMouseEnterSideNavItem(t){this.clearMouseEnterNavItem().makeSideNavItemActive(n()(t))}onMouseClickSideNavItem(t){const e=n()(t.currentTarget);this.clearMouseEnterNavItem().makeSideNavItemActive(e)}bindGetNavItemInfoOnWindowResize(){window.addEventListener("resize",Object(h["a"])((()=>{this.storedNavItemPositionAndWidthInfo=this.setStoredNavItemPositionAndWidthInfo()}),200))}clearLeaveNavTimeout(){if(this.leaveNavTimeout){window.clearTimeout(this.leaveNavTimeout);this.leaveNavTimeout=null}return this}clearMouseEnterNavItem(){if(this.mouseEnterNavItemTimeout){window.clearTimeout(this.mouseEnterNavItemTimeout);this.mouseEnterNavItemTimeout=null}return this}getAllNavLinks(){return Array.from(this.$navCategoryLinks).concat(Array.from(this.$navPromoLinks)).map((t=>n()(t)))}setStoredNavItemPositionAndWidthInfo(){return this.allNavLinks.map((t=>({data:t.data(),width:t.width(),position:t.position()})))}getStoredNavItemPositionAndWidthInfo(t){return this.storedNavItemPositionAndWidthInfo.find((e=>e.data===(null===t||void 0===t?void 0:t.data())))}getDataAttributeString(t){return`[data-node-id="${t}"]`}hasActiveTopNavLink(){return this.$navCategoryLinks.filter(".active").length>0||this.$navPromoLinks.filter(".active").length>0}getActiveTopNavLink(){return this.allNavLinks.find((t=>n()(t).hasClass("active")))}getFirstFocusableChildForSelector(t){return this.$context.find(`${t} ${m.MENUITEM}`).first()}makeSideNavItemActive(t){Math.random()<.01&&v["a"].increment("nav.category.open.sub_category");const e=t.data("node-id");if("A"===t.children().first().get(0).tagName)return this;this.clearActiveSideNavItems();t.addClass("active");this.hide(m.TERTIARY_NAV).show(m.TERTIARY_NAV+this.getDataAttributeString(e)).setMenuKeyboardNavigation(m.TERTIARY_NAV+this.getDataAttributeString(e));return this}makeActiveNavItem(t){Math.random()<.01&&v["a"].increment("nav.category.open.top_category");this.makeActiveNavItemIndicator(t);return this}makeActiveNavItemIndicator(t){const e=this.getStoredNavItemPositionAndWidthInfo(t)||{width:0,position:{left:0,top:0}};const a=e.width;const i=e.position;if(this.hasActiveTopNavLink()){this.clearActiveNavItems();t.addClass("active");this.$activeNavItemIndicator.addClass("animate-all").css("left",i.left).css("width",a)}else{t.addClass("active");const e=i.left+.5*a;this.$activeNavItemIndicator.css("left",e).css("width",a)}}shrinkActiveNavItemIndicator(){const t=this.getActiveTopNavLink();const e=this.getStoredNavItemPositionAndWidthInfo(t);if(!e)return;{const t=e.width;const a=e.position;const i=a.left+.5*t;this.$activeNavItemIndicator.css("left",i).removeClass("animate-all").css("width",0)}}clearActiveNavItems(){this.$navCategoryLinks.removeClass("active");this.$navPromoLinks.removeClass("active");return this}clearActiveSideNavItems(){this.$sideNavCategoryLinks.removeClass("active");return this}show(t){this.$context.find(t).removeClass(_.DISPLAY_NONE).attr("aria-hidden","false");return this}hide(t){this.$context.find(t).addClass(_.DISPLAY_NONE).attr("aria-hidden","true");return this}focus(t){this.$context.find(`${t} ${m.MENUITEM}`).trigger("focus");return this}onTabAway(){this.clearLeaveNavTimeout().clearMouseEnterNavItem().clearActiveNavItems().hide(m.SUB_NAV)}setAriaActiveDescendant(t,e){this.$context.find(t).parent("ul").attr("aria-activedescendant",e);return this}setMenuKeyboardNavigation(t){c["a"].setMenuKeyboardNavigation(this.$context.find(t),{shiftTabTriggersLeave:true});return this}setA11yInitialStateMenubar(){const t=this.$navCategoryLinks.find(m.MENUITEM);const e=t.first();e.attr("tabindex","0");this.$topNavCategoryList.attr("aria-activedescendant",e.attr("id"));return this}bindA11yEvents(){if(!this.$topNavCategoryList||this.$topNavCategoryList.length<1)return this;r.setMenubarKeyboardNavigation(this.$topNavCategoryList);this.$context.on("keydown.catnav",(t=>{this.$searchResults.hide();t.keyCode!==o["a"].TAB||t.shiftKey||this.onTabAway()}));this.$topNavCategoryList.on("menubar-item-press",m.MENUITEM,(t=>{const e=n()(t.currentTarget);if("true"!==e.attr("aria-haspopup")||this.hideSubNav)e.attr("href")&&"#"!==e.attr("href")?window.location.assign(e.attr("href")):this.hideSubNav&&window.location.assign(e.parent().attr("href"));else{const t=e.closest('[data-ui="top-nav-category-link"]');this.onKeyActivateTopNavItem(t)}}));return this}bindA11yEventsSideNav(){this.$sideNavCategoryList.on("menu-item-open-submenu menu-item-activate",m.MENUITEM,(t=>{const e=n()(t.target);if("true"===e.attr("aria-haspopup")){const t=e.parent("li");const a=t.data("node-id");this.makeSideNavItemActive(t).getFirstFocusableChildForSelector(m.TERTIARY_NAV+this.getDataAttributeString(a)).trigger("focus")}else"menu-item-activate"===t.type&&e.attr("href")&&"#"!==e.attr("href")&&window.location.assign(e.attr("href"))}));this.$sideNavCategoryList.on("menu-item-leave",m.MENUITEM,(t=>{const e=n()(t.target);const a=e.parents("ul").data("node-id");this.hide(m.SUB_NAV).clearActiveNavItems().focus(m.TOP_NAV_CATEGORY_LINK+this.getDataAttributeString(a))}));return this}bindA11yEventsTertiaryNav(){this.$tertiaryNavs.on("menu-item-leave",m.MENUITEM,(t=>{const e=n()(t.target);const a=e.parents(m.TERTIARY_NAV);const i=a.data("node-id");const s=a.attr("data-has-side-nav");if("false"===s){this.hide(m.SUB_NAV).clearActiveNavItems().focus(m.TOP_NAV_CATEGORY_LINK+this.getDataAttributeString(i));return}this.focus(m.SIDE_NAV_CATEGORY_LINK+this.getDataAttributeString(i))}));this.$tertiaryNavs.on("menu-item-activate",m.MENUITEM,(t=>{window.location.assign(n()(t.target).attr("href"))}));this.$tertiaryNavs.on("menu-item-open-submenu menu-item-activate",m.MENUITEM,(t=>{const e=n()(t.target);const a=e.closest(m.MENU);const i=a.siblings(m.PROMO);i.find(":focusable").eq(0).trigger("focus")}));this.$promos.on("keyup",(t=>{const e=n()(t.target);if(t.keyCode===o["a"].LEFT||t.shiftKey&&t.keyCode===o["a"].TAB){t.preventDefault();const a=e.closest(m.PROMO);const i=a.siblings(m.TERTIARY_NAV).filter(":not(:hidden)");i.find(":focusable").eq(0).trigger("focus")}else if(t.keyCode===o["a"].ESC){t.preventDefault();const a=e.closest(m.SUB_NAV).data("node-id");this.hide(m.SUB_NAV).clearActiveNavItems().focus(m.TOP_NAV_CATEGORY_LINK+this.getDataAttributeString(a))}}));return this}}var I=E;var T=a("/wG7");var g=a("KWsK");const f={KEY:"catnav",NAME:"CategoryNav_V2_ApiSpec_SubNav"};const p={CAT_NAV:'[id="desktop-category-nav"]',TOP_NAV_LIST:'[data-ui="top-nav-category-list"]',SUB_NAV_CONTAINER:'[data-ui="sub-nav-container"]',SUB_NAV:'[data-ui="sub-nav"]',GIFT_GUIDE_TREATMENT:"[data-cyber-gift-guide-treatment]",SALE_PROMO_TREATMENT:"[data-cyber-sale-treatment]",SALE_PROMO_CONTROL:"[data-cyber-sale-control]"};const S=n()(p.CAT_NAV);const b=S.find(p.TOP_NAV_LIST);const O=S.find(p.SUB_NAV);const C=S.find(p.GIFT_GUIDE_TREATMENT);const y=S.find(p.SALE_PROMO_TREATMENT);const k=S.find(p.SALE_PROMO_CONTROL);const L=l["a"].getBoolean("should_hide_sub_nav",false);C.on("click",(()=>{d["default"].logEvent({event_name:"catnav_gifts_clicked"})}));y.on("click",(()=>{d["default"].logEvent({event_name:"catnav_saletreatment_clicked"})}));k.on("click",(()=>{d["default"].logEvent({event_name:"catnav_salecontrol_clicked"})}));if((null===b||void 0===b?void 0:b.children().length)>0)if(0!==O.length||L)new I(S);else{const t=T["a"].getSpecArgsForSpec(f.NAME,p.CAT_NAV);T["a"].fetchOne(f.KEY,f.NAME,t,"GET",true).done((t=>{if(t.output&&t.output[f.KEY]){var e;null===S||void 0===S||null===(e=S.find(`${p.SUB_NAV_CONTAINER} ${T["a"].DEFAULT_PLACEHOLDER_SELECTOR}`))||void 0===e?void 0:e.replaceWith(t.output[f.KEY]);new I(S)}else g["a"].captureMessage("Desktop CatNav NeuSpec data.output not defined",{level:"info",extra:{specKey:f.KEY,specName:f.NAME,data:t}})}))}},uEZf:function(t,e,a){"use strict";a.r(e);var i=a("3a3M");var n=a.n(i);var s=a("H3fw");var o=a("w1yB");var r=a("TVrR");var c=a("Z2Mz");function d(t,e,a){e in t?Object.defineProperty(t,e,{value:a,enumerable:true,configurable:true,writable:true}):t[e]=a;return t}class v{constructor(t){d(this,"eventCallback",void 0);d(this,"batches",void 0);this.eventCallback=t;this.batches={}}addNewBatch(t,e,a,i,n){this.batches[t]={totalItems:n,targetBatchSize:i,eventData:a,eventName:e,currBatchCount:0,itemsSeenCount:0}}clearBatch(t){const e=this.batches[t];if(void 0!==e){e.eventData={};e.currBatchCount=0}}addToBatch(t,e){const a=this.batches[t];if(a){const t=Object.keys(a.eventData).length>0?a.eventData:e.common||{};const i=e.view||{};Object.keys(i).forEach((e=>{const a=i[e];if(t[e]){var n;null===(n=t[e])||void 0===n?void 0:n.push(a)}else t[e]=[a]}));a.eventData=t;a.currBatchCount++;a.itemsSeenCount++}}shouldClearBatch(t){const e=this.batches[t];if(e)return e.currBatchCount===e.targetBatchSize||e.itemsSeenCount===e.totalItems;return false}logAndClearBatch(t){const e=this.batches[t];if(e){this.eventCallback(e.eventName,e.eventData);this.clearBatch(t)}}handleBatchItem(t,e,a){const{total_items:i,key:n,size:s}=t;this.batches[n]||this.addNewBatch(n,e,a.common||{},s,i);this.addToBatch(n,a);this.shouldClearBatch(n)&&this.logAndClearBatch(n)}}var h=v;var u=a("OHqh");const l=function(t,e){let a;if("recommendations_module"===e["rec_event_name"]){a=`${e["rec_event_name"]}_seen`;c["a"].increment(`neu.appears_logger.recommendations_module_seen.${e["module_placement"]}`,.1)}else a=`${t}_seen`;s["default"].logEvent(n.a.extend({event_name:a},e))};const N=new h(l);const m=function(t){const e=n()(t).data("logger-id");const a=e?o["a"].getString(`${e}.component_name`):n()(t).data("appears-component-name");if(a){let i=e?JSON.parse(o["a"].getString(`${e}.event_data`)):n()(t).data("appears-event-data");if(i&&i.common&&i.common.skip_logging)return;const s=n()(t).data("appears-batch-options")||false;if(s){N.handleBatchItem(s,a,i);return}n.a.isPlainObject(i)||(i={});const r=n()(t).data("appears-log-breakpoint");r&&(i["browser_breakpoint"]=u["a"].getCurrentBreakpoint());l(a,i)}else c["a"].increment("neu.appears_logger.unknown_component")};const _={setup(t){const e="[data-appears-component-name], [data-logger-id]";const a=t?t.find(e):n()(e);a.each(((t,e)=>{const a=e.querySelectorAll(":scope > :not(.appears-ready)");a.forEach((t=>{Object(r["a"])(t,(()=>{m(e)}),{threshold:n()(e).data("offset")||.5})}))})).children().addClass("appears-ready")}};var A=e["default"]=_}}]);
//# sourceMappingURL=https://www.etsy.com/sourcemaps/evergreenVendor/fr/async/common-entrypoints/auto/bootstrap/category-nav/v2/nav.562f96c2b8a66d5d2bc2.js.map