(window["jsonp-common-entrypoints"]=window["jsonp-common-entrypoints"]||[]).push([["auto/bootstrap/category-nav/v2/mobile/nav"],{"0IbO":function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var n=a("3a3M");var o=a.n(n);const i="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend transitionend webkitTransitionEnd MSTransitionEnd otransitionend",s="animation webkitAnimation mozAnimation MSAnimation oanimation transition webkitTransition MSTransition otransition",r=function(){false;return s.split(" ").some((t=>Object.prototype.hasOwnProperty.call(document.body.style,t)))};const l=function(t){t.stopPropagation();return true};function c(t,e,{onBeforeTransitionEnd:a=l,keepClass:n=false,baseAnimationClass:s="animated"}={}){const c=o.a.Deferred();if(!r())return c.resolve();const h=function(o){if(a(o)){t.removeClass(s).off(i,h);n||t.removeClass(e);c.resolve()}};t.addClass(s).addClass(e).on(i,h);return c.promise()}},AXLb:function(t,e,a){"use strict";a.r(e);var n=a("3a3M");var o=a.n(n);var i=a("Sc5Q");var s=a("V9r9");var r=a("PggL");var l=a("XkxG");var c=a("0IbO");var h=a("w1yB");var d=a("H3fw");var u=a("zxUc");var v=a("uEZf");function _(t,e,a){e in t?Object.defineProperty(t,e,{value:a,enumerable:true,configurable:true,writable:true}):t[e]=a;return t}const N={MOBILE_CATNAV_WRAPPER:"#mobile-catnav-overlay",TOP_NAV_CATEGORY_CONTAINER:'[data-ui="mobile-top-catnav-container"]',TOP_NAV_CATEGORY_LINK:'[data-ui="mobile-top-nav-category-link"]',SUB_NAV_CATEGORY_CONTAINER:'[data-ui="mobile-sub-catnav-container"]',SUB_NAV_CATEGORY_LINK:'[data-ui="mobile-sub-category-link"]',TER_NAV_CATEGORY_CONTAINER:'[data-ui="mobile-tertiary-catnav-container"]',TER_NAV_CATEGORY_LINK:'[data-ui="mobile-tertiary-category-link"]',ONSALE_LINK:'[data-ui="mobile-catnav-onsale-link"]',MOBILE_CATNAV_BACK_BUTTON:'[data-ui="mobile-catnav-back-btn"]',MOBILE_CATNAV_MENU:"#mobile-catnav-menu",TOP_NAV_TITLE:"#mobile-catnav-header-title",SUB_NAV_TITLE:"#mobile-sub-catnav-header-title",TER_NAV_TITLE:"#mobile-tertiary-catnav-header-title",MODAL_CONTAINER:"#etsy-modal-container",OVERLAY_MASK:"[data-overlay-mask]",OVERLAY_CONTENT_WRAPPER:"[data-overlay-content-wrapper]",GNAV:"#gnav-header-inner",OVERLAY_INNER:'[data-ui="mobile-cat-nav"]',HEADER:'[data-ui="mobile-catnav-header"]',SCROLL_WRAPPER:'[data-ui="mobile-catnav-scroll-wrapper"]',LAZY_IMAGES:"[data-mobile-cat-nav-lazy-image] noscript",MOBILE_TOP_NAV_PROMO:'[data-ui="mobile-top-nav-promo-link"]',MOBILE_SUB_NAV_PROMO:'[data-ui="mobile-sub-nav-promo-link"]',GIFT_GUIDE:"[data-mobile-gift-guide]",CYBER_SALE:"[data-mobile-cyber-sale]",COLLAGE_BUTTONS:".wt-btn",MOBILE_CATNAV_CLOSE_BUTTON:"#category-nav-close-button"};const E="gifting_catnav_flyout_js";const m={DISPLAY_NONE:"wt-display-none",OVERLAY_MASK:"mobile-catnav-overlay-mask",ANIMATIONS:{SLIDE_FROM_LEFT:"wt-animated--slide-from-left",BACK_BUTTON_ENTER:"catnav-animated-drift-left-in",BACK_BUTTON_LEAVE:"catnav-animated-drift-right-out",TITLE_ENTER:"catnav-animated-drift-right-in",TITLE_LEAVE:"catnav-animated-drift-left-out",SUB_NAV_IN:"wt-animated--slide-from-right"}};const T={TRANSITION_END:"transitionend"};const A=640;class f{constructor(t){_(this,"$context",void 0);_(this,"$mobileCatnavMenu",void 0);_(this,"$topNavTitle",void 0);_(this,"$subNavTitle",void 0);_(this,"$terNavTitle",void 0);_(this,"$topNavCategoryLinks",void 0);_(this,"$subNavLinks",void 0);_(this,"$backButton",void 0);_(this,"$searchResults",void 0);_(this,"$overlay",void 0);_(this,"$overlayInner",void 0);_(this,"$gnav",void 0);_(this,"$header",void 0);_(this,"browseTitle",void 0);_(this,"$scrollWrapper",void 0);_(this,"didLoadLazyImages",void 0);_(this,"$lazyImages",void 0);_(this,"$overlayContainer",void 0);_(this,"$overlayMask",void 0);_(this,"$overlayContentWrapper",void 0);_(this,"collageOverlay",void 0);_(this,"$showing",void 0);this.$context=t;this.$mobileCatnavMenu=o()(N.MOBILE_CATNAV_MENU);this.$topNavTitle=o()(N.TOP_NAV_TITLE);this.$subNavTitle=o()(N.SUB_NAV_TITLE);this.$terNavTitle=o()(N.TER_NAV_TITLE);this.$topNavCategoryLinks=this.$context.find(N.TOP_NAV_CATEGORY_LINK);this.$subNavLinks=this.$context.find(N.SUB_NAV_CATEGORY_LINK);this.$backButton=this.$context.find(N.MOBILE_CATNAV_BACK_BUTTON);this.$searchResults=o()(".gnav-search-inner").find("[data-id='search-suggestions']");this.$overlay=o()(N.MOBILE_CATNAV_WRAPPER);this.$overlayInner=this.$overlay.find(N.OVERLAY_INNER);this.$gnav=o()(N.GNAV);this.$header=this.$context.find(N.HEADER);this.browseTitle=this.$header.find("[data-categories-translation]").data("categories-translation");this.$scrollWrapper=this.$context.find(N.SCROLL_WRAPPER);this.$topNavTitle.html(this.browseTitle);this.didLoadLazyImages=false;this.$lazyImages=this.$overlayInner.find(N.LAZY_IMAGES);const e=this.$overlay[0];if(e instanceof HTMLElement&&e.querySelector("[data-overlay-modal]")){const t=h["a"].getBoolean("relocate_cat_nav",false)?{customTrigger:true}:{};this.collageOverlay=new l["a"](e,t)}this.$overlayContainer=o()(N.MODAL_CONTAINER);this.$overlayMask=this.$overlayContainer.find(N.OVERLAY_MASK);this.$overlayContentWrapper=this.$overlayContainer.find(N.OVERLAY_CONTENT_WRAPPER);this.$showing=this.$topNavTitle;this.bindEvents();v["default"].setup(this.$context)}bindEvents(){this.listenForCategoryNavOpenFromSearchDropdown();this.captureTransitionEnd();this.$context.on("click",N.TOP_NAV_CATEGORY_LINK,o.a.proxy(this.onMouseClickInNavItem,this)).on("keydown",N.TOP_NAV_CATEGORY_LINK,o.a.proxy(this.onKeyDownInNavItem,this)).on("click",N.SUB_NAV_CATEGORY_LINK,o.a.proxy(this.onMouseClickInNavItem,this)).on("keydown",N.SUB_NAV_CATEGORY_LINK,o.a.proxy(this.onKeyDownInNavItem,this)).on("click",N.MOBILE_CATNAV_BACK_BUTTON,o.a.proxy(this.onMouseClickBack,this)).on("click",N.ONSALE_LINK,(()=>{d["default"].logEvent({event_name:"mobile_nav_onsale_click"})})).on("touchstart",N.MOBILE_TOP_NAV_PROMO,(t=>{const e=o()(t.currentTarget).data("eventName");d["default"].logEvent({event_name:"mobile_top_nav_promo_click",promo_name:e})})).on("touchstart",N.MOBILE_SUB_NAV_PROMO,(t=>{const e=o()(t.currentTarget).data("nodeId");d["default"].logEvent({event_name:"mobile_sub_nav_promo_click",node_id:e})})).on("touchstart",N.CYBER_SALE,(()=>{d["default"].logEvent({event_name:"catnav_mobile_sale_clicked"})})).on("touchstart",N.GIFT_GUIDE,(()=>{d["default"].logEvent({event_name:"catnav_mobile_gifts_clicked"})}));h["a"].getBoolean("relocate_cat_nav",false)&&this.$context.on("click",N.MOBILE_CATNAV_CLOSE_BUTTON,(()=>{const t=o()("#global-enhancements-search-query");o()("html, body").animate({scrollTop:t});t.focus()}));this.$overlay.on(r["a"].EVENTS.BEFORE_OPEN,o.a.proxy(this.onBeforeOpen,this));this.$overlay.on(r["a"].EVENTS.CLOSE,o.a.proxy(this.onClose,this));this.$overlay.on(r["a"].EVENTS.BEFORE_OPEN,o.a.proxy(this.onOpen,this))}listenForCategoryNavOpenFromSearchDropdown(){document.addEventListener("categoryNavOpenFromSearchDropdown",(()=>{this.openCatNavOverlay()}))}openCatNavOverlay(){var t;null===(t=this.collageOverlay)||void 0===t?void 0:t.open()}captureTransitionEnd(){this.$context.find(N.COLLAGE_BUTTONS).each(((t,e)=>{e.addEventListener(T.TRANSITION_END,(t=>{t.stopPropagation()}),true)}))}onMouseClickInNavItem(t){d["default"].logEvent({event_name:"mobile_category_nav_click"});const e=o()(t.currentTarget);const a=e.attr("aria-controls");const n=e.data("name");this.show(`#${a} ul`);if(this.$backButton.hasClass(m.DISPLAY_NONE)){this.show(N.MOBILE_CATNAV_BACK_BUTTON);Object(c["a"])(this.$backButton,m.ANIMATIONS.BACK_BUTTON_ENTER)}if(e.hasClass("top-nav-item")){this.$backButton.data("subnav-id",a);this.$backButton.data("subnav-name",n);this.show(`#${a}-ep`);this.hide(N.TOP_NAV_CATEGORY_CONTAINER);this.hide(N.MOBILE_CATNAV_MENU);this.$subNavTitle.html(n);this.showTitle(this.$subNavTitle,this.$topNavTitle,false,true)}else if(e.hasClass("subnav-item")&&!e.data().isViewAllCategoryLink){this.$backButton.data("ternav-id",a);this.hide(N.SUB_NAV_CATEGORY_CONTAINER);this.$terNavTitle.html(n);this.showTitle(this.$terNavTitle,this.$subNavTitle,false,true)}e.attr("aria-expanded","true");Object(c["a"])(o()(`#${a}`),m.ANIMATIONS.SUB_NAV_IN).then(o.a.proxy((()=>{i["a"].setFocusToFirstFocusableElement(o()(`#${a} ul`),o()(N.MOBILE_CATNAV_CLOSE_BUTTON))}),this))}onKeyDownInNavItem(t){t.which!==s["a"].ENTER&&t.which!==s["a"].SPACE||this.onMouseClickInNavItem(t)}onMouseClickBack(){const t=this.$backButton.data("ternav-id");const e=this.$backButton.data("subnav-id");if("0"!==t){o()(`[aria-controls="${t}"]`).attr("aria-expanded","false");this.hide(`#${t} ul`);this.show(`#${e} ul`);this.showTitle(this.$subNavTitle,this.$terNavTitle,true,true);this.$backButton.data("subnav_name","");this.$backButton.data("ternav-id","0");Object(c["a"])(o()(`#${e}`),m.ANIMATIONS.SLIDE_FROM_LEFT).then(o.a.proxy((()=>{i["a"].setFocusToFirstFocusableElement(o()(`#${e}`),o()(N.MOBILE_CATNAV_CLOSE_BUTTON))}),this))}else{o()(`[aria-controls="${e}"]`).attr("aria-expanded","false");this.hide(`#${e} ul`);this.showTopLevel(true);Object(c["a"])(o()(".mobile-topnav"),m.ANIMATIONS.SLIDE_FROM_LEFT).then(o.a.proxy((()=>{i["a"].setFocusToFirstFocusableElement(o()(".mobile-topnav"),o()(N.MOBILE_CATNAV_CLOSE_BUTTON))}),this))}}onBeforeOpen(){this.$overlayMask.addClass(m.OVERLAY_MASK);this.$overlayContentWrapper.addClass(m.OVERLAY_MASK);this.setOverlayHeight();if(!this.didLoadLazyImages){this.loadLazyImages();this.didLoadLazyImages=true}}onOpen(){i["a"].setFocusToFirstFocusableElement(o()(".mobile-topnav"),o()(N.MOBILE_CATNAV_CLOSE_BUTTON));d["default"].logEvent({event_name:"mobile_category_nav_open",gift_guide_flyout_enabled:h["a"].getBoolean(E,false)})}setOverlayHeight(){const t=this.$gnav.outerHeight();o()(window).width()<A?this.$overlayInner.css({top:`${t}px`,height:`calc(100vh - ${t}px)`}):this.$overlayInner.css({top:"0",height:"100vh"})}loadLazyImages(){this.$lazyImages.each((function(){const t=o()(this);t.replaceWith(t.text())}))}onClose(){const t=this.$backButton.data("ternav-id");const e=this.$backButton.data("subnav-id");this.hide(`#${t} ul`);this.hide(this.$terNavTitle.selector);this.hide(`#${e} ul`);this.showTopLevel(false);this.$overlayMask.removeClass(m.OVERLAY_MASK);this.$overlayContentWrapper.removeClass(m.OVERLAY_MASK);d["default"].logEvent({event_name:"mobile_category_nav_close"})}showTopLevel(t){this.show(N.MOBILE_CATNAV_MENU);this.show("[data-ui=mobile-top-catnav-container]");this.showTitle(this.$topNavTitle,this.$subNavTitle,true,t);this.$backButton.data("subnav-id","0");this.$backButton.hasClass(m.DISPLAY_NONE)||Object(c["a"])(this.$backButton,m.ANIMATIONS.BACK_BUTTON_LEAVE).then((()=>{this.hide(N.MOBILE_CATNAV_BACK_BUTTON)}))}showTitle(t,e,a,n){const o=a?"BACK_BUTTON":"TITLE";t.removeClass(m.DISPLAY_NONE);if(n){t.stop();e.stop();Object(c["a"])(t,m.ANIMATIONS[`${o}_ENTER`]);this.$showing=t;Object(c["a"])(e,m.ANIMATIONS[`${o}_LEAVE`]).then((()=>{this.$showing.is(e)||e.addClass(m.DISPLAY_NONE)}))}else e.addClass(m.DISPLAY_NONE)}show(t){this.$context.find(t).removeClass(m.DISPLAY_NONE).attr("aria-hidden","false");return this}hide(t){this.$context.find(t).addClass(m.DISPLAY_NONE).attr("aria-hidden","true");return this}}var O=a("/wG7");var b=a("ilZA");var p=a("oVvz");const g=function(t){let e=false,a;return function(){if(e)return a;e=true;a=t.apply(this,arguments);return a}};var C=g;var I=a("KWsK");const y=639;const L=900;const $="gifting_catnav_flyout_js";function B(){const t={KEY:"catnav-mobile",NAME:"CategoryNav_V2_Mobile_ApiSpec_CategoryNav"};const e={MOBILE_CAT_NAV:"#mobile-catnav-overlay"};const a=o()(e.MOBILE_CAT_NAV);const n=h["a"].getString("mott_version");const i=h["a"].getBoolean("catnav_show_sales",false);const s=h["a"].getString("catnav_gift_guide","control");const r=h["a"].getBoolean($,false);let l=0;if(1===a.length){l=a.children().length;if(0===l){const e={mott_version:n,show_sales:i,catnav_gift_guide:s,gifting_catnav_flyout_js:r,locale:Object(p["a"])()};O["a"].fetchOne(t.KEY,t.NAME,e,"GET",true).done((e=>{if(e.output&&e.output[t.KEY]){a.html(e.output[t.KEY]);new f(a)}else I["a"].captureMessage("Mobile CatNav NeuSpec data.output not defined",{level:"info",extra:{specKey:t.KEY,specName:t.NAME,data:e}})}))}else 1===l&&new f(a)}}const w=C(B);function S(){if(o()(window).width()<=L){o()(window).off("resize.catnav-mobile");w();o()(window).width()>y&&d["default"].logEvent({event_name:"md-breakpoint-catnav"})}}if(o()(window).width()>L)o()(window).on("resize.catnav-mobile",Object(b["a"])(S,1e3));else{o()(B);o()(window).width()>y&&d["default"].logEvent({event_name:"md-breakpoint-catnav"})}},Sc5Q:function(t,e,a){"use strict";var n=a("3a3M");var o=a.n(n);var i=a("V9r9");const s="data-aria-hidden-by-contain-focus";const r=()=>{o()(document).off(".a11yContainFocus")};const l=()=>{o()(`[${s}]`).removeAttr(`${"aria-hidden"+" "}${s}`)};const c=t=>{let e=[];if(t){e=t.siblings().toArray();const a=t.parent();const n=a.prop("tagName");n&&"body"!==n.toLowerCase()&&(e=e.concat(c(a)))}return e};const h="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex]:not([disabled]), *[contenteditable]";const d=t=>{const e=c(t);for(let a=0;a<e.length;a++){const t=e[a];if(t&&!t.getAttribute("aria-hidden")){t.setAttribute("aria-hidden","true");t.setAttribute(s,"true")}}};const u=t=>t instanceof o.a;const v=t=>{const e=u(t)?t:o()(t);d(e);r();if(!e.length)return;o()(document).on("keydown.a11yContainFocus",(t=>{if(t.keyCode===i["a"].TAB){const a=document.activeElement?o()(document.activeElement):null;const n=e.find(h).filter(":not(:hidden)");const i=a?n.index(a):-1;if(t.shiftKey&&i<=0){const e=n.get(n.length-1);e.focus();t.preventDefault()}if(!t.shiftKey&&(i===n.length-1||i<0)){n.first().trigger("focus");t.preventDefault()}}}))};const _=(t,e)=>{if(t&&e){const a=t instanceof o.a?t:o()(t);const n=document.activeElement?o()(document.activeElement):null;const i=a.find(h).filter(":not(:hidden)");const s=n?i.index(n):-1;if(e.shiftKey&&0===s)return true;if(!e.shiftKey&&s===i.length-1)return true}return false};const N=(t,e)=>{const a=t instanceof o.a?t:o()(t);const n=a.find(h).filter(":not(:hidden)");const i=n.not(e);const s=i.filter('[role="tab"]');0===n.length?a.trigger("focus"):1===n.length||0===i.length?n.first().trigger("focus"):i.first().is(s)?s.filter('[aria-selected="true"]').trigger("focus"):i.first().trigger("focus")};const E=t=>{const e=t instanceof o.a?t:o()(t);return e.find(h).filter(":not(:hidden)")};const m=()=>{r();l()};e["a"]={FOCUSABLE_ELEMENTS:h,containFocusInElement:v,isLastFocusableItem:_,getFocusableElementsInContainer:E,setFocusToFirstFocusableElement:N,removeContainFocus:m}},ilZA:function(t,e,a){"use strict";const n=function(t,e){let a;let n;let o;let i;let s=0;const r=function(){s=new Date(Date.now());o=null;i=t.apply(a,n)};return function(...l){const c=new Date(Date.now());const h=e-(c.valueOf()-s.valueOf());a=this;n=l;if(h<=0){null!==o&&clearTimeout(o);o=null;s=c;i=t.apply(a,n)}else o||(o=setTimeout(r,h));return i}};e["a"]=n},uEZf:function(t,e,a){"use strict";a.r(e);var n=a("3a3M");var o=a.n(n);var i=a("H3fw");var s=a("w1yB");var r=a("TVrR");var l=a("Z2Mz");function c(t,e,a){e in t?Object.defineProperty(t,e,{value:a,enumerable:true,configurable:true,writable:true}):t[e]=a;return t}class h{constructor(t){c(this,"eventCallback",void 0);c(this,"batches",void 0);this.eventCallback=t;this.batches={}}addNewBatch(t,e,a,n,o){this.batches[t]={totalItems:o,targetBatchSize:n,eventData:a,eventName:e,currBatchCount:0,itemsSeenCount:0}}clearBatch(t){const e=this.batches[t];if(void 0!==e){e.eventData={};e.currBatchCount=0}}addToBatch(t,e){const a=this.batches[t];if(a){const t=Object.keys(a.eventData).length>0?a.eventData:e.common||{};const n=e.view||{};Object.keys(n).forEach((e=>{const a=n[e];if(t[e]){var o;null===(o=t[e])||void 0===o?void 0:o.push(a)}else t[e]=[a]}));a.eventData=t;a.currBatchCount++;a.itemsSeenCount++}}shouldClearBatch(t){const e=this.batches[t];if(e)return e.currBatchCount===e.targetBatchSize||e.itemsSeenCount===e.totalItems;return false}logAndClearBatch(t){const e=this.batches[t];if(e){this.eventCallback(e.eventName,e.eventData);this.clearBatch(t)}}handleBatchItem(t,e,a){const{total_items:n,key:o,size:i}=t;this.batches[o]||this.addNewBatch(o,e,a.common||{},i,n);this.addToBatch(o,a);this.shouldClearBatch(o)&&this.logAndClearBatch(o)}}var d=h;var u=a("OHqh");const v=function(t,e){let a;if("recommendations_module"===e["rec_event_name"]){a=`${e["rec_event_name"]}_seen`;l["a"].increment(`neu.appears_logger.recommendations_module_seen.${e["module_placement"]}`,.1)}else a=`${t}_seen`;i["default"].logEvent(o.a.extend({event_name:a},e))};const _=new d(v);const N=function(t){const e=o()(t).data("logger-id");const a=e?s["a"].getString(`${e}.component_name`):o()(t).data("appears-component-name");if(a){let n=e?JSON.parse(s["a"].getString(`${e}.event_data`)):o()(t).data("appears-event-data");if(n&&n.common&&n.common.skip_logging)return;const i=o()(t).data("appears-batch-options")||false;if(i){_.handleBatchItem(i,a,n);return}o.a.isPlainObject(n)||(n={});const r=o()(t).data("appears-log-breakpoint");r&&(n["browser_breakpoint"]=u["a"].getCurrentBreakpoint());v(a,n)}else l["a"].increment("neu.appears_logger.unknown_component")};const E={setup(t){const e="[data-appears-component-name], [data-logger-id]";const a=t?t.find(e):o()(e);a.each(((t,e)=>{const a=e.querySelectorAll(":scope > :not(.appears-ready)");a.forEach((t=>{Object(r["a"])(t,(()=>{N(e)}),{threshold:o()(e).data("offset")||.5})}))})).children().addClass("appears-ready")}};var m=e["default"]=E}}]);
//# sourceMappingURL=https://www.etsy.com/sourcemaps/evergreenVendor/en-US/async/common-entrypoints/auto/bootstrap/category-nav/v2/mobile/nav.2893553b9bcfe583fddd.js.map